<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title></title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://daurnimator.github.io/lua.vm.js/lua.vm.js"></script>
  </head>
  <body>
    <h1>神戸の天気</h1>
    <ul id="test"></ul>
    <script type="text/lua">
      local prefixUrl = "http://allow-any-origin.appspot.com/";
      _ = js.global.jQuery;

      function callback(text)
        local json = js.global.JSON:parse(text)
        js.global.console:log(json);
        -- for forecast in json.forecasts do
        -- end
        -- js.global:alert(json)
      end

      local data = nil
      local jqxhr = _:get(prefixUrl..'http://weather.livedoor.com/forecast/webservice/json/v1?city=280010', data)
      jqxhr:done(function() callback(jqxhr.responseText) end)
    </script>
  </body>
</html>
